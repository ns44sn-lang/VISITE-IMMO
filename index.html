<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Visite ImmobiliÃ¨re</title>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:ital,wght@0,400;0,700;1,400&family=DM+Sans:wght@300;400;500;600&family=Sarabun:wght@300;400;500&display=swap" rel="stylesheet" />
  <style>
    :root {
      --cream: #f5f0e8; --dark: #1a1a18; --accent: #c8873a;
      --accent-light: #e8b97a; --muted: #7a7570; --card: #ffffff;
      --border: #e2ddd5; --good: #4a8c6f; --neutral: #c8a84b; --bad: #b85040;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body { font-family: 'DM Sans','Sarabun',sans-serif; background:var(--cream); color:var(--dark); min-height:100vh; }
    @keyframes fadeUp { from{opacity:0;transform:translateY(14px)} to{opacity:1;transform:translateY(0)} }
    @keyframes fadeIn { from{opacity:0} to{opacity:1} }
    .fade-in { animation: fadeIn 0.4s ease both; }

    /* â”€â”€â”€ LANDING â”€â”€â”€ */
    #landing {
      min-height:100vh; display:flex; flex-direction:column;
      align-items:center; justify-content:center;
      background:var(--dark); padding:40px 20px 60px;
      position:relative; overflow:hidden;
    }
    #landing::before { content:''; position:absolute; top:-100px; right:-100px; width:500px; height:500px; border:80px solid rgba(200,135,58,0.07); border-radius:50%; }
    #landing::after  { content:''; position:absolute; bottom:-80px; left:-80px; width:350px; height:350px; border:60px solid rgba(200,135,58,0.05); border-radius:50%; }
    .landing-inner { position:relative; z-index:1; max-width:580px; width:100%; text-align:center; }
    .landing-badge {
      display:inline-block; font-size:10px; letter-spacing:3px;
      text-transform:uppercase; color:var(--accent);
      border:1px solid rgba(200,135,58,0.35); padding:5px 16px;
      border-radius:20px; margin-bottom:24px;
    }
    .landing-title { font-family:'Playfair Display',serif; font-size:clamp(30px,6vw,52px); font-weight:400; color:var(--cream); line-height:1.1; margin-bottom:10px; }
    .landing-title em { font-style:italic; color:var(--accent-light); }
    .landing-sub { font-size:14px; color:rgba(245,240,232,0.4); margin-bottom:44px; font-weight:300; }
    .step-label { font-size:10px; letter-spacing:3px; text-transform:uppercase; color:rgba(245,240,232,0.3); margin-bottom:12px; }
    .step-title { font-family:'Playfair Display',serif; font-size:19px; color:var(--cream); margin-bottom:18px; font-weight:400; }

    /* Country grid */
    .country-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:12px; margin-bottom:36px; }
    @media(max-width:480px){.country-grid{grid-template-columns:1fr;}}
    .country-card {
      border:1.5px solid rgba(245,240,232,0.1); border-radius:14px;
      padding:22px 12px; cursor:pointer; transition:all 0.25s;
      background:rgba(255,255,255,0.03); text-align:center; user-select:none;
    }
    .country-card:hover { border-color:var(--accent); background:rgba(200,135,58,0.08); transform:translateY(-2px); }
    .country-card.selected { border-color:var(--accent); background:rgba(200,135,58,0.14); }
    .country-flag { font-size:38px; margin-bottom:8px; }
    .country-name { font-size:14px; font-weight:600; color:var(--cream); margin-bottom:3px; }
    .country-currency { font-size:10px; color:rgba(245,240,232,0.35); }

    /* Lang grid */
    #step2 { display:none; }
    .lang-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; margin-bottom:28px; }
    @media(max-width:480px){.lang-grid{grid-template-columns:1fr;}}
    .lang-card {
      border:1.5px solid rgba(245,240,232,0.1); border-radius:12px;
      padding:16px 10px; cursor:pointer; transition:all 0.2s;
      background:rgba(255,255,255,0.03); text-align:center; user-select:none;
    }
    .lang-card:hover { border-color:var(--accent); background:rgba(200,135,58,0.08); }
    .lang-card.selected { border-color:var(--accent); background:rgba(200,135,58,0.15); }
    .lang-flag { font-size:26px; margin-bottom:5px; }
    .lang-name { font-size:12px; font-weight:600; color:var(--cream); }
    .btn-start {
      display:none; font-family:'DM Sans',sans-serif; font-size:14px; font-weight:600;
      letter-spacing:1.5px; text-transform:uppercase; background:var(--accent);
      color:#fff; border:none; padding:17px 46px; border-radius:12px;
      cursor:pointer; transition:all 0.2s;
    }
    .btn-start.visible { display:inline-block; animation:fadeUp 0.3s ease both; }
    .btn-start:hover { background:var(--accent-light); transform:translateY(-2px); box-shadow:0 8px 24px rgba(200,135,58,0.3); }

    /* â”€â”€â”€ FORM PAGE â”€â”€â”€ */
    #formPage { display:none; padding-bottom:60px; }
    .top-bar {
      background:var(--dark); padding:9px 22px;
      display:flex; align-items:center; justify-content:space-between;
      gap:10px; flex-wrap:wrap;
    }
    .top-bar-left { display:flex; align-items:center; gap:8px; }
    .top-bar-flag { font-size:20px; }
    .top-bar-name { font-size:13px; font-weight:600; color:var(--cream); }
    .top-bar-right { display:flex; gap:5px; align-items:center; }
    .lang-btn {
      background:transparent; border:1.5px solid rgba(245,240,232,0.18);
      color:rgba(245,240,232,0.55); font-family:'DM Sans',sans-serif;
      font-size:10px; font-weight:600; padding:4px 9px; border-radius:20px;
      cursor:pointer; transition:all 0.2s;
    }
    .lang-btn:hover { border-color:var(--accent); color:var(--accent); }
    .lang-btn.active { background:var(--accent); border-color:var(--accent); color:#fff; }
    .btn-back {
      font-family:'DM Sans',sans-serif; font-size:10px; font-weight:600;
      background:transparent; border:1.5px solid rgba(245,240,232,0.12);
      color:rgba(245,240,232,0.4); padding:4px 12px; border-radius:20px;
      cursor:pointer; transition:all 0.2s;
    }
    .btn-back:hover { color:var(--cream); border-color:rgba(245,240,232,0.4); }

    /* Hero */
    .hero { background:var(--dark); color:var(--cream); padding:30px 36px; position:relative; overflow:hidden; }
    .hero::before { content:''; position:absolute; top:-60px; right:-60px; width:240px; height:240px; border:36px solid rgba(200,135,58,0.1); border-radius:50%; }
    .hero-inner { max-width:720px; margin:0 auto; position:relative; z-index:1; }
    .hero-label { font-size:10px; letter-spacing:3px; text-transform:uppercase; color:var(--accent); margin-bottom:8px; }
    .hero h1 { font-family:'Playfair Display',serif; font-size:clamp(20px,4vw,34px); font-weight:400; line-height:1.15; margin-bottom:5px; }
    .hero h1 em { font-style:italic; color:var(--accent-light); }
    .hero p { font-size:13px; color:rgba(245,240,232,0.45); font-weight:300; }

    /* Sections */
    .form-wrap { max-width:720px; margin:0 auto; padding:0 18px; }
    .section { background:var(--card); border-radius:14px; padding:26px; margin-top:18px; border:1px solid var(--border); }
    .section-header { display:flex; align-items:center; gap:10px; margin-bottom:18px; padding-bottom:12px; border-bottom:1px solid var(--border); }
    .section-icon { width:32px; height:32px; background:var(--dark); color:var(--accent); border-radius:7px; display:flex; align-items:center; justify-content:center; font-size:14px; flex-shrink:0; }
    .section-title { font-family:'Playfair Display',serif; font-size:16px; font-weight:400; }
    .section-sub { font-size:11px; color:var(--muted); margin-top:1px; }

    .grid-2 { display:grid; grid-template-columns:1fr 1fr; gap:13px; }
    .grid-3 { display:grid; grid-template-columns:1fr 1fr 1fr; gap:13px; }
    @media(max-width:520px){.grid-2,.grid-3{grid-template-columns:1fr;}}

    .field { display:flex; flex-direction:column; gap:5px; }
    .field label { font-size:10px; letter-spacing:1px; text-transform:uppercase; color:var(--muted); font-weight:500; }
    .field input,.field select,.field textarea {
      font-family:'DM Sans','Sarabun',sans-serif; font-size:14px;
      padding:9px 12px; border:1.5px solid var(--border); border-radius:8px;
      background:var(--cream); color:var(--dark);
      transition:border-color 0.2s,box-shadow 0.2s; outline:none; width:100%;
    }
    .field input:focus,.field select:focus,.field textarea:focus { border-color:var(--accent); box-shadow:0 0 0 3px rgba(200,135,58,0.12); }
    .field textarea { resize:vertical; min-height:70px; }

    /* Currency conversion box */
    .price-convert {
      margin-top:10px; background:linear-gradient(135deg,#1a1a18,#252520);
      border-radius:12px; padding:15px 16px; display:none;
      border:1px solid rgba(200,135,58,0.15);
    }
    .price-convert.visible { display:block; animation:fadeIn 0.3s ease; }
    .conv-header { font-size:9px; letter-spacing:2px; text-transform:uppercase; color:rgba(200,135,58,0.65); margin-bottom:12px; }
    .conv-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:10px; }
    @media(max-width:460px){.conv-grid{grid-template-columns:1fr;}}
    .conv-item { text-align:center; padding:8px 4px; }
    .conv-currency { font-size:9px; color:rgba(245,240,232,0.3); letter-spacing:1px; text-transform:uppercase; margin-bottom:3px; }
    .conv-amount { font-family:'Playfair Display',serif; font-size:19px; color:var(--cream); }
    .conv-sym { font-size:12px; color:var(--accent); margin-left:2px; font-family:'DM Sans',sans-serif; }

    /* Price m2 box */
    .price-m2-box {
      margin-top:8px; background:rgba(200,135,58,0.07);
      border:1px solid rgba(200,135,58,0.2); border-radius:10px;
      padding:12px 14px; display:none;
    }
    .price-m2-box.visible { display:block; animation:fadeIn 0.3s ease; }
    .m2-header { font-size:9px; letter-spacing:2px; text-transform:uppercase; color:var(--accent); margin-bottom:10px; opacity:0.75; }
    .m2-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:8px; }
    @media(max-width:460px){.m2-grid{grid-template-columns:1fr;}}
    .m2-item { text-align:center; }
    .m2-label { font-size:9px; letter-spacing:1px; text-transform:uppercase; color:var(--muted); margin-bottom:2px; }
    .m2-value { font-size:15px; font-weight:600; color:var(--accent); }

    /* Map */
    .map-btn {
      font-family:'DM Sans',sans-serif; font-size:11px; font-weight:600;
      background:var(--dark); color:var(--cream); border:none;
      padding:8px 16px; border-radius:7px; cursor:pointer;
      transition:background 0.2s; margin-top:9px; display:inline-block;
    }
    .map-btn:hover { background:var(--accent); }
    #map { width:100%; height:250px; border-radius:10px; border:1.5px solid var(--border); margin-top:9px; background:#e8e4dc; display:none; overflow:hidden; }
    #map.visible { display:block; }
    #map iframe { width:100%; height:100%; border:none; }

    /* Type buttons */
    .type-grid { display:grid; grid-template-columns:repeat(4,1fr); gap:7px; }
    @media(max-width:460px){.type-grid{grid-template-columns:1fr 1fr;}}
    .type-btn { border:1.5px solid var(--border); background:var(--cream); border-radius:9px; padding:9px 5px; cursor:pointer; text-align:center; transition:all 0.2s; user-select:none; }
    .type-btn input { display:none; }
    .type-btn .icon { font-size:19px; margin-bottom:3px; }
    .type-btn .lbl { font-size:10px; font-weight:500; color:var(--muted); }
    .type-btn:hover { border-color:var(--accent-light); }
    .type-btn.selected { border-color:var(--accent); background:#fff8f0; }
    .type-btn.selected .lbl { color:var(--accent); }

    /* Stars */
    .star-row { display:flex; align-items:center; gap:8px; padding:8px 0; border-bottom:1px solid var(--border); }
    .star-row:last-child { border-bottom:none; }
    .star-name { font-size:12px; font-weight:500; flex:1; min-width:95px; }
    .stars { display:flex; flex-direction:row-reverse; justify-content:flex-end; gap:2px; }
    .stars input { display:none; }
    .stars label { font-size:19px; color:#d9d3c9; cursor:pointer; transition:color 0.15s; line-height:1; }
    .stars label:hover,.stars label:hover~label { color:var(--accent-light); }
    .stars input:checked~label { color:var(--accent); }
    .star-comment { font-size:11px; padding:4px 8px; border:1px solid var(--border); border-radius:6px; background:var(--cream); color:var(--dark); outline:none; width:110px; font-family:'DM Sans','Sarabun',sans-serif; transition:border-color 0.2s; }
    .star-comment:focus { border-color:var(--accent); }
    @media(max-width:520px){.star-comment{width:65px;}}

    /* Score */
    .score-display { display:flex; align-items:center; gap:14px; padding:16px; background:var(--dark); border-radius:11px; margin-top:14px; }
    .score-num { font-family:'Playfair Display',serif; font-size:40px; color:var(--accent); line-height:1; }
    .score-small { font-size:11px; color:rgba(245,240,232,0.38); }
    .score-bar-wrap { flex:1; }
    .score-bar { height:5px; background:rgba(255,255,255,0.1); border-radius:99px; overflow:hidden; }
    .score-bar-fill { height:100%; background:linear-gradient(90deg,var(--accent),var(--accent-light)); border-radius:99px; transition:width 0.4s; width:0%; }
    .score-verdict { font-size:12px; color:rgba(245,240,232,0.6); margin-top:5px; }

    /* Decision */
    .decision-grid { display:grid; grid-template-columns:repeat(3,1fr); gap:9px; }
    .decision-btn { padding:13px 8px; border-radius:9px; border:1.5px solid var(--border); background:var(--cream); cursor:pointer; text-align:center; transition:all 0.2s; user-select:none; }
    .decision-btn input { display:none; }
    .decision-btn .d-icon { font-size:20px; margin-bottom:3px; }
    .decision-btn .d-label { font-size:11px; font-weight:600; }
    .decision-btn[data-val="oui"].selected { border-color:var(--good); background:#f0faf5; }
    .decision-btn[data-val="peut-etre"].selected { border-color:var(--neutral); background:#fffbf0; }
    .decision-btn[data-val="non"].selected { border-color:var(--bad); background:#fdf5f4; }

    .mt10 { margin-top:10px; }
    .mt14 { margin-top:14px; }

    /* Submit */
    .submit-wrap { text-align:center; margin-top:26px; }
    .btn-submit {
      font-family:'DM Sans',sans-serif; font-size:13px; font-weight:600;
      letter-spacing:1.5px; text-transform:uppercase;
      background:var(--dark); color:var(--cream);
      border:none; padding:15px 42px; border-radius:10px;
      cursor:pointer; transition:all 0.2s;
      position:relative; overflow:hidden;
    }
    .btn-submit::after { content:''; position:absolute; inset:0; background:var(--accent); transform:translateX(-100%); transition:transform 0.3s; }
    .btn-submit:hover::after { transform:translateX(0); }
    .btn-submit span { position:relative; z-index:1; }

    /* Result */
    #result { display:none; margin-top:18px; background:var(--dark); color:var(--cream); border-radius:14px; padding:26px; }
    #result h2 { font-family:'Playfair Display',serif; font-size:19px; margin-bottom:12px; color:var(--accent-light); }
    #result pre { white-space:pre-wrap; line-height:1.75; color:rgba(245,240,232,0.8); font-size:12px; }
    .result-actions { display:flex; gap:9px; margin-top:14px; flex-wrap:wrap; }
    .btn-action { font-family:'DM Sans',sans-serif; font-size:11px; font-weight:600; letter-spacing:1px; text-transform:uppercase; border:1.5px solid rgba(245,240,232,0.22); background:transparent; color:var(--cream); padding:8px 16px; border-radius:7px; cursor:pointer; transition:all 0.2s; }
    .btn-action:hover { background:var(--accent); border-color:var(--accent); }

    @media print {
      .top-bar,.hero,.submit-wrap,.result-actions,#landing,.map-btn{display:none!important}
      #result{display:block!important;background:#fff;color:#000;border:1px solid #ccc;}
      .section{break-inside:avoid;}
    }
  </style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LANDING â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="landing">
  <div class="landing-inner">
    <div class="landing-badge">Immobilier Â· Real Estate Â· à¸­à¸ªà¸±à¸‡à¸«à¸²à¸£à¸´à¸¡à¸—à¸£à¸±à¸à¸¢à¹Œ</div>
    <h1 class="landing-title">Fiche de visite<br><em>immobiliÃ¨re</em></h1>
    <p class="landing-sub">Comparez vos visites Â· Compare your visits Â· à¹€à¸›à¸£à¸µà¸¢à¸šà¹€à¸—à¸µà¸¢à¸šà¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡</p>

    <!-- STEP 1 -->
    <div id="step1">
      <div class="step-label">Ã‰tape 1 / Step 1 / à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 1</div>
      <div class="step-title">Choisissez votre pays Â· Choose your country Â· à¹€à¸¥à¸·à¸­à¸à¸›à¸£à¸°à¹€à¸—à¸¨</div>
      <div class="country-grid">
        <div class="country-card" onclick="selectCountry('fr')" id="cc-fr">
          <div class="country-flag">ğŸ‡«ğŸ‡·</div>
          <div class="country-name">France</div>
          <div class="country-currency">â‚¬ Euro â†’ $ USD Â· à¸¿ THB</div>
        </div>
        <div class="country-card" onclick="selectCountry('pt')" id="cc-pt">
          <div class="country-flag">ğŸ‡µğŸ‡¹</div>
          <div class="country-name">Portugal</div>
          <div class="country-currency">â‚¬ Euro â†’ $ USD Â· à¸¿ THB</div>
        </div>
        <div class="country-card" onclick="selectCountry('th')" id="cc-th">
          <div class="country-flag">ğŸ‡¹ğŸ‡­</div>
          <div class="country-name">ThaÃ¯lande</div>
          <div class="country-currency">à¸¿ THB â†’ â‚¬ Euro Â· $ USD</div>
        </div>
      </div>
    </div>

    <!-- STEP 2 -->
    <div id="step2">
      <div class="step-label">Ã‰tape 2 / Step 2 / à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸—à¸µà¹ˆ 2</div>
      <div class="step-title">Langue du formulaire Â· Form language Â· à¸ à¸²à¸©à¸²à¸‚à¸­à¸‡à¹à¸šà¸šà¸Ÿà¸­à¸£à¹Œà¸¡</div>
      <div class="lang-grid">
        <div class="lang-card" onclick="selectLang('fr')" id="lc-fr">
          <div class="lang-flag">ğŸ‡«ğŸ‡·</div>
          <div class="lang-name">FranÃ§ais</div>
        </div>
        <div class="lang-card" onclick="selectLang('en')" id="lc-en">
          <div class="lang-flag">ğŸ‡¬ğŸ‡§</div>
          <div class="lang-name">English</div>
        </div>
        <div class="lang-card" onclick="selectLang('th')" id="lc-th">
          <div class="lang-flag">ğŸ‡¹ğŸ‡­</div>
          <div class="lang-name">à¸ à¸²à¸©à¸²à¹„à¸—à¸¢</div>
        </div>
      </div>
      <button class="btn-start" id="btnStart" onclick="startForm()">Ouvrir le formulaire â†’</button>
    </div>
  </div>
</div>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• FORM PAGE â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="formPage">

  <div class="top-bar">
    <div class="top-bar-left">
      <span class="top-bar-flag" id="topFlag">ğŸ‡«ğŸ‡·</span>
      <span class="top-bar-name" id="topName">France</span>
    </div>
    <div class="top-bar-right">
      <button class="lang-btn" onclick="setLang('fr')">ğŸ‡«ğŸ‡· FR</button>
      <button class="lang-btn" onclick="setLang('en')">ğŸ‡¬ğŸ‡§ EN</button>
      <button class="lang-btn" onclick="setLang('th')">ğŸ‡¹ğŸ‡­ TH</button>
      <button class="btn-back" onclick="goBack()">â† Accueil</button>
    </div>
  </div>

  <div class="hero">
    <div class="hero-inner">
      <div class="hero-label" data-i18n="hero_label">Fiche de visite</div>
      <h1 data-i18n="hero_title">Rapport de visite <em>immobiliÃ¨re</em></h1>
      <p data-i18n="hero_sub">Remplissez cette fiche pendant ou aprÃ¨s chaque visite.</p>
    </div>
  </div>

  <form id="visitForm" class="form-wrap" onsubmit="return false;">

    <!-- SECTION 1: INFOS -->
    <div class="section">
      <div class="section-header">
        <div class="section-icon">ğŸ </div>
        <div>
          <div class="section-title" data-i18n="s1_title">Informations du bien</div>
          <div class="section-sub" data-i18n="s1_sub">Adresse, type, surface et prix</div>
        </div>
      </div>

      <div class="field" style="margin-bottom:9px;"><label data-i18n="lbl_type">Type de bien</label></div>
      <div class="type-grid">
        <label class="type-btn selected" onclick="selectType(this)"><input type="radio" name="type" value="apt" checked/><div class="icon">ğŸ¢</div><div class="lbl" data-i18n="type_apt">Appartement</div></label>
        <label class="type-btn" onclick="selectType(this)"><input type="radio" name="type" value="house"/><div class="icon">ğŸ¡</div><div class="lbl" data-i18n="type_house">Maison</div></label>
        <label class="type-btn" onclick="selectType(this)"><input type="radio" name="type" value="studio"/><div class="icon">ğŸ›</div><div class="lbl" data-i18n="type_studio">Studio</div></label>
        <label class="type-btn" onclick="selectType(this)"><input type="radio" name="type" value="commercial"/><div class="icon">ğŸ¬</div><div class="lbl" data-i18n="type_commercial">Local</div></label>
      </div>

      <div class="field mt14">
        <label data-i18n="lbl_address">Adresse complÃ¨te</label>
        <input type="text" name="adresse" id="adresseInput" data-i18n-ph="ph_address" placeholder="12 rue des Lilas, 75011 Paris"/>
      </div>
      <button type="button" class="map-btn" onclick="showMap()" data-i18n="btn_map">ğŸ“ Voir sur la carte</button>
      <div id="map"></div>

      <div class="grid-3 mt14">
        <div class="field"><label data-i18n="lbl_surface">Surface (mÂ²)</label><input type="number" name="surface" id="surfInput" placeholder="65" min="0"/></div>
        <div class="field"><label data-i18n="lbl_rooms">PiÃ¨ces</label><input type="number" name="pieces" placeholder="3" min="0"/></div>
        <div class="field"><label data-i18n="lbl_floor">Ã‰tage</label><input type="text" name="etage" placeholder="3/5"/></div>
      </div>

      <div class="grid-2 mt14">
        <div class="field">
          <label data-i18n="lbl_price">Prix demandÃ©</label>
          <input type="text" name="prix" id="prixInput" data-i18n-ph="ph_price" placeholder="280 000 â‚¬"/>
        </div>
        <div class="field">
          <label data-i18n="lbl_date">Date de visite</label>
          <input type="date" name="date_visite" id="dateVisit"/>
        </div>
      </div>

      <!-- CONVERSION BOX -->
      <div class="price-convert" id="priceConvert">
        <div class="conv-header" data-i18n="conv_title">Conversion automatique des devises</div>
        <div class="conv-grid">
          <div class="conv-item">
            <div class="conv-currency" id="convLbl1">EUR</div>
            <div class="conv-amount" id="convAmt1">â€”</div>
          </div>
          <div class="conv-item">
            <div class="conv-currency" id="convLbl2">USD</div>
            <div class="conv-amount" id="convAmt2">â€”</div>
          </div>
          <div class="conv-item">
            <div class="conv-currency" id="convLbl3">THB</div>
            <div class="conv-amount" id="convAmt3">â€”</div>
          </div>
        </div>
      </div>

      <!-- PRICE M2 BOX -->
      <div class="price-m2-box" id="priceM2Box">
        <div class="m2-header" data-i18n="m2_title">Prix au mÂ²</div>
        <div class="m2-grid">
          <div class="m2-item"><div class="m2-label" id="m2Lbl1">â‚¬ / mÂ²</div><div class="m2-value" id="m2Val1">â€”</div></div>
          <div class="m2-item"><div class="m2-label">$ / mÂ²</div><div class="m2-value" id="m2Val2">â€”</div></div>
          <div class="m2-item"><div class="m2-label">à¸¿ / mÂ²</div><div class="m2-value" id="m2Val3">â€”</div></div>
        </div>
      </div>

      <div class="grid-2 mt14">
        <div class="field"><label data-i18n="lbl_agent">Agent / Contact</label><input type="text" name="agent" data-i18n-ph="ph_agent" placeholder="Nom de l'agence"/></div>
        <div class="field">
          <label data-i18n="lbl_expo">Exposition</label>
          <select name="exposition">
            <option value="" data-i18n="opt_choose">â€” Choisir â€”</option>
            <option>N</option><option>S</option><option>E</option><option>O/W</option>
            <option>NE</option><option>NO/NW</option><option>SE</option><option>SO/SW</option>
          </select>
        </div>
      </div>
      <div class="grid-2 mt10">
        <div class="field">
          <label data-i18n="lbl_dpe">DPE / Ã‰nergie</label>
          <select name="dpe">
            <option value="">â€”</option>
            <option>A</option><option>B</option><option>C</option><option>D</option><option>E</option><option>F</option><option>G</option>
          </select>
        </div>
        <div class="field"><label data-i18n="lbl_charges">Charges / mois</label><input type="text" name="charges" data-i18n-ph="ph_charges" placeholder="250 â‚¬/mois"/></div>
      </div>
    </div>

    <!-- SECTION 2: NOTATION -->
    <div class="section">
      <div class="section-header">
        <div class="section-icon">â­</div>
        <div>
          <div class="section-title" data-i18n="s2_title">Ã‰tat gÃ©nÃ©ral â€” notation</div>
          <div class="section-sub" data-i18n="s2_sub">1 Ã  5 Ã©toiles par piÃ¨ce</div>
        </div>
      </div>
      <div id="starField"></div>
      <div class="score-display">
        <div>
          <div class="score-num" id="scoreNum">â€”</div>
          <div class="score-small">/ 5</div>
        </div>
        <div class="score-bar-wrap">
          <div class="score-small" style="color:rgba(245,240,232,0.45);margin-bottom:5px;" data-i18n="score_global">Score global</div>
          <div class="score-bar"><div class="score-bar-fill" id="scoreBar"></div></div>
          <div class="score-verdict" id="scoreVerdict" data-i18n="score_hint">Notez les piÃ¨ces</div>
        </div>
      </div>
      <div class="field mt10">
        <label data-i18n="lbl_comment">Commentaire gÃ©nÃ©ral</label>
        <textarea name="comment_etat" data-i18n-ph="ph_comment" placeholder="LuminositÃ©, Ã©tat gÃ©nÃ©ralâ€¦"></textarea>
      </div>
    </div>

    <!-- SECTION 3: POINTS CLÃ‰S -->
    <div class="section">
      <div class="section-header">
        <div class="section-icon">ğŸ“‹</div>
        <div>
          <div class="section-title" data-i18n="s3_title">Points clÃ©s</div>
          <div class="section-sub" data-i18n="s3_sub">Atouts, dÃ©fauts, travaux</div>
        </div>
      </div>
      <div class="grid-2">
        <div class="field"><label data-i18n="lbl_positifs">âœ… Points positifs</label><textarea name="positifs" data-i18n-ph="ph_positifs" placeholder="Vue, calmeâ€¦"></textarea></div>
        <div class="field"><label data-i18n="lbl_negatifs">âš ï¸ Points nÃ©gatifs</label><textarea name="negatifs" data-i18n-ph="ph_negatifs" placeholder="Bruit, humiditÃ©â€¦"></textarea></div>
      </div>
      <div class="field mt10">
        <label data-i18n="lbl_travaux">ğŸ”¨ Travaux estimÃ©s</label>
        <input type="text" name="travaux" data-i18n-ph="ph_travaux" placeholder="Cuisine Ã  refaire â€” ~8 000 â‚¬"/>
      </div>
    </div>

    <!-- SECTION 4: DÃ‰CISION -->
    <div class="section">
      <div class="section-header">
        <div class="section-icon">ğŸ¯</div>
        <div>
          <div class="section-title" data-i18n="s4_title">DÃ©cision</div>
          <div class="section-sub" data-i18n="s4_sub">Votre verdict</div>
        </div>
      </div>
      <div class="decision-grid">
        <label class="decision-btn" data-val="oui" onclick="selectDecision(this)"><input type="radio" name="decision" value="oui"/><div class="d-icon">âœ…</div><div class="d-label" style="color:var(--good)" data-i18n="dec_yes">IntÃ©ressÃ©</div></label>
        <label class="decision-btn" data-val="peut-etre" onclick="selectDecision(this)"><input type="radio" name="decision" value="peut-etre"/><div class="d-icon">ğŸ¤”</div><div class="d-label" style="color:var(--neutral)" data-i18n="dec_maybe">Peut-Ãªtre</div></label>
        <label class="decision-btn" data-val="non" onclick="selectDecision(this)"><input type="radio" name="decision" value="non"/><div class="d-icon">âŒ</div><div class="d-label" style="color:var(--bad)" data-i18n="dec_no">Non retenu</div></label>
      </div>
      <div class="field mt10">
        <label data-i18n="lbl_notes">Notes personnelles</label>
        <textarea name="notes" data-i18n-ph="ph_notes" placeholder="Prochaines Ã©tapesâ€¦"></textarea>
      </div>
    </div>

    <div class="submit-wrap">
      <button class="btn-submit" onclick="generateReport()"><span data-i18n="btn_generate">GÃ©nÃ©rer le rapport</span></button>
    </div>

    <div id="result">
      <h2>ğŸ“„ <span data-i18n="result_title">Rapport de visite</span></h2>
      <pre id="resultText"></pre>
      <div class="result-actions">
        <button class="btn-action" onclick="copyReport()">ğŸ“‹ <span data-i18n="btn_copy">Copier</span></button>
        <button class="btn-action" onclick="printPage()">ğŸ–¨ <span data-i18n="btn_print">Imprimer</span></button>
        <button class="btn-action" onclick="resetForm()">â• <span data-i18n="btn_new">Nouvelle visite</span></button>
      </div>
    </div>

  </form>
</div>

<script>
/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
   RATES (approximate hardcoded rates)
   Update periodically for accuracy
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• */
const R = { EUR_USD:1.08, EUR_THB:38.5, THB_EUR:0.026, THB_USD:0.028 };

const COUNTRIES = {
  fr:{ flag:'ğŸ‡«ğŸ‡·', name:'France',    cur:'EUR', sym:'â‚¬' },
  pt:{ flag:'ğŸ‡µğŸ‡¹', name:'Portugal',  cur:'EUR', sym:'â‚¬' },
  th:{ flag:'ğŸ‡¹ğŸ‡­', name:'ThaÃ¯lande', cur:'THB', sym:'à¸¿' }
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• TRANSLATIONS */
const T = {
fr:{
  hero_label:'Fiche de visite', hero_title:'Rapport de visite <em>immobiliÃ¨re</em>',
  hero_sub:'Remplissez cette fiche pendant ou aprÃ¨s chaque visite.',
  s1_title:'Informations du bien', s1_sub:'Adresse, type, surface et prix',
  lbl_type:'Type de bien', type_apt:'Appartement', type_house:'Maison', type_studio:'Studio', type_commercial:'Local',
  lbl_address:'Adresse complÃ¨te', ph_address:'12 rue des Lilas, 75011 Paris',
  btn_map:'ğŸ“ Voir sur la carte',
  lbl_surface:'Surface (mÂ²)', lbl_rooms:'PiÃ¨ces', lbl_floor:'Ã‰tage',
  lbl_price:'Prix demandÃ©', ph_price:'280 000 â‚¬',
  lbl_date:'Date de visite', lbl_agent:'Agent / Contact', ph_agent:"Nom de l'agence",
  lbl_expo:'Exposition', lbl_dpe:'DPE', opt_choose:'â€” Choisir â€”',
  lbl_charges:'Charges / mois', ph_charges:'250 â‚¬/mois',
  conv_title:'Conversion automatique des devises', m2_title:'Prix au mÂ²',
  s2_title:'Ã‰tat gÃ©nÃ©ral â€” notation', s2_sub:'1 Ã  5 Ã©toiles par piÃ¨ce',
  score_global:'Score global', score_hint:'Notez les piÃ¨ces ci-dessus',
  score_excellent:'ğŸŒŸ Excellent bien', score_good:'ğŸ‘ Bien intÃ©ressant',
  score_neutral:'ğŸ¤” Quelques rÃ©serves', score_bad:'âš ï¸ Nombreux dÃ©fauts',
  lbl_comment:'Commentaire gÃ©nÃ©ral', ph_comment:'LuminositÃ©, Ã©tat gÃ©nÃ©ralâ€¦',
  s3_title:'Points clÃ©s', s3_sub:'Atouts, dÃ©fauts, travaux',
  lbl_positifs:'âœ… Points positifs', ph_positifs:'Vue, calmeâ€¦',
  lbl_negatifs:'âš ï¸ Points nÃ©gatifs', ph_negatifs:'Bruit, humiditÃ©â€¦',
  lbl_travaux:'ğŸ”¨ Travaux estimÃ©s', ph_travaux:'Cuisine Ã  refaire â€” ~8 000 â‚¬',
  s4_title:'DÃ©cision', s4_sub:'Votre verdict',
  dec_yes:'IntÃ©ressÃ©', dec_maybe:'Peut-Ãªtre', dec_no:'Non retenu',
  lbl_notes:'Notes personnelles', ph_notes:'Prochaines Ã©tapesâ€¦',
  btn_generate:'GÃ©nÃ©rer le rapport', result_title:'Rapport de visite',
  btn_copy:'Copier', btn_print:'Imprimer', btn_new:'Nouvelle visite',
  confirm_reset:'RÃ©initialiser le formulaire ?', copied:'Rapport copiÃ© !',
  rooms:['Salon / SÃ©jour','Cuisine','Chambre principale','Chambre 2','Salle de bain','WC','EntrÃ©e','ExtÃ©rieur / Balcon'],
  star_ph:'commentaireâ€¦',
  rh:'FICHE DE VISITE IMMOBILIÃˆRE',
  rt:'Type',ra:'Adresse',rd:'Date',rag:'Agent',rs:'Surface',rr:'PiÃ¨ces',rf:'Ã‰tage',
  re:'Exposition',rdpe:'DPE',rp:'Prix',rconv:'Conversions',rm2:'Prix au mÂ²',
  rrating:'NOTATION PAR PIÃˆCE',rscore:'Score',retat:'Ã‰tat gÃ©nÃ©ral',rkeys:'POINTS CLÃ‰S',
  rpos:'Positifs',rneg:'NÃ©gatifs',rworks:'Travaux',rdec:'DÃ‰CISION',rnotes:'Notes',
  dl:{ oui:'âœ… IntÃ©ressÃ©','peut-etre':'ğŸ¤” Peut-Ãªtre', non:'âŒ Non retenu' },
  na:'â€”', unrated:'(non notÃ©)', nonotes:'(aucune note)',
  tl:{ apt:'Appartement', house:'Maison', studio:'Studio', commercial:'Local commercial' }
},
en:{
  hero_label:'Visit report', hero_title:'Property visit <em>report</em>',
  hero_sub:'Fill in this form during or after each visit.',
  s1_title:'Property information', s1_sub:'Address, type, area and price',
  lbl_type:'Property type', type_apt:'Apartment', type_house:'House', type_studio:'Studio', type_commercial:'Commercial',
  lbl_address:'Full address', ph_address:'123 Main St, Bangkok 10110',
  btn_map:'ğŸ“ View on map',
  lbl_surface:'Area (mÂ²)', lbl_rooms:'Rooms', lbl_floor:'Floor',
  lbl_price:'Asking price', ph_price:'5,000,000 à¸¿',
  lbl_date:'Visit date', lbl_agent:'Agent / Contact', ph_agent:'Agent or agency name',
  lbl_expo:'Orientation', lbl_dpe:'Energy rating', opt_choose:'â€” Choose â€”',
  lbl_charges:'Monthly charges', ph_charges:'250 â‚¬/month',
  conv_title:'Automatic currency conversion', m2_title:'Price per mÂ²',
  s2_title:'Condition â€” room ratings', s2_sub:'1 to 5 stars per room',
  score_global:'Overall score', score_hint:'Rate the rooms above',
  score_excellent:'ğŸŒŸ Excellent property', score_good:'ğŸ‘ Interesting',
  score_neutral:'ğŸ¤” Some reservations', score_bad:'âš ï¸ Many issues',
  lbl_comment:'General comment', ph_comment:'Natural light, overall conditionâ€¦',
  s3_title:'Key points', s3_sub:'Pros, cons and works',
  lbl_positifs:'âœ… Pros', ph_positifs:'View, quietâ€¦',
  lbl_negatifs:'âš ï¸ Cons', ph_negatifs:'Noise, dampnessâ€¦',
  lbl_travaux:'ğŸ”¨ Estimated works', ph_travaux:'Kitchen renovation â€” ~8,000 â‚¬',
  s4_title:'Decision', s4_sub:'Your verdict',
  dec_yes:'Interested', dec_maybe:'Maybe', dec_no:'Not retained',
  lbl_notes:'Personal notes', ph_notes:'Next stepsâ€¦',
  btn_generate:'Generate report', result_title:'Visit report',
  btn_copy:'Copy', btn_print:'Print', btn_new:'New visit',
  confirm_reset:'Reset the form?', copied:'Report copied!',
  rooms:['Living room','Kitchen','Master bedroom','Bedroom 2','Bathroom','Toilet','Entrance','Exterior / Balcony'],
  star_ph:'commentâ€¦',
  rh:'PROPERTY VISIT REPORT',
  rt:'Type',ra:'Address',rd:'Date',rag:'Agent',rs:'Area',rr:'Rooms',rf:'Floor',
  re:'Orientation',rdpe:'Energy',rp:'Price',rconv:'Conversions',rm2:'Price/mÂ²',
  rrating:'ROOM RATINGS',rscore:'Score',retat:'Condition',rkeys:'KEY POINTS',
  rpos:'Pros',rneg:'Cons',rworks:'Works',rdec:'DECISION',rnotes:'Notes',
  dl:{ oui:'âœ… Interested','peut-etre':'ğŸ¤” Maybe', non:'âŒ Not retained' },
  na:'â€”', unrated:'(not rated)', nonotes:'(no notes)',
  tl:{ apt:'Apartment', house:'House', studio:'Studio', commercial:'Commercial' }
},
th:{
  hero_label:'à¹à¸šà¸šà¸Ÿà¸­à¸£à¹Œà¸¡à¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡', hero_title:'à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡ <em>à¸­à¸ªà¸±à¸‡à¸«à¸²à¸£à¸´à¸¡à¸—à¸£à¸±à¸à¸¢à¹Œ</em>',
  hero_sub:'à¸à¸£à¸­à¸à¹à¸šà¸šà¸Ÿà¸­à¸£à¹Œà¸¡à¸™à¸µà¹‰à¸£à¸°à¸«à¸§à¹ˆà¸²à¸‡à¸«à¸£à¸·à¸­à¸«à¸¥à¸±à¸‡à¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡à¹à¸•à¹ˆà¸¥à¸°à¸„à¸£à¸±à¹‰à¸‡',
  s1_title:'à¸‚à¹‰à¸­à¸¡à¸¹à¸¥à¸­à¸ªà¸±à¸‡à¸«à¸²à¸£à¸´à¸¡à¸—à¸£à¸±à¸à¸¢à¹Œ', s1_sub:'à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ à¸›à¸£à¸°à¹€à¸ à¸— à¸‚à¸™à¸²à¸” à¹à¸¥à¸°à¸£à¸²à¸„à¸²',
  lbl_type:'à¸›à¸£à¸°à¹€à¸ à¸—', type_apt:'à¸„à¸­à¸™à¹‚à¸”', type_house:'à¸šà¹‰à¸²à¸™', type_studio:'à¸ªà¸•à¸¹à¸”à¸´à¹‚à¸­', type_commercial:'à¸à¸²à¸“à¸´à¸Šà¸¢à¹Œ',
  lbl_address:'à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆà¹€à¸•à¹‡à¸¡', ph_address:'123 à¸–.à¸ªà¸¸à¸‚à¸¸à¸¡à¸§à¸´à¸— à¸à¸£à¸¸à¸‡à¹€à¸—à¸à¸¯ 10110',
  btn_map:'ğŸ“ à¸”à¸¹à¸šà¸™à¹à¸œà¸™à¸—à¸µà¹ˆ',
  lbl_surface:'à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ (à¸•à¸£.à¸¡.)', lbl_rooms:'à¸ˆà¸³à¸™à¸§à¸™à¸«à¹‰à¸­à¸‡', lbl_floor:'à¸Šà¸±à¹‰à¸™',
  lbl_price:'à¸£à¸²à¸„à¸²à¸—à¸µà¹ˆà¸‚à¸­', ph_price:'5,000,000 à¸¿',
  lbl_date:'à¸§à¸±à¸™à¸—à¸µà¹ˆà¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡', lbl_agent:'à¸•à¸±à¸§à¹à¸—à¸™', ph_agent:'à¸Šà¸·à¹ˆà¸­à¸•à¸±à¸§à¹à¸—à¸™à¸«à¸£à¸·à¸­à¸šà¸£à¸´à¸©à¸±à¸—',
  lbl_expo:'à¸—à¸´à¸¨à¸—à¸²à¸‡', lbl_dpe:'à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™', opt_choose:'â€” à¹€à¸¥à¸·à¸­à¸ â€”',
  lbl_charges:'à¸„à¹ˆà¸²à¹ƒà¸Šà¹‰à¸ˆà¹ˆà¸²à¸¢/à¹€à¸”à¸·à¸­à¸™', ph_charges:'5,000 à¸¿/à¹€à¸”à¸·à¸­à¸™',
  conv_title:'à¸à¸²à¸£à¹à¸›à¸¥à¸‡à¸ªà¸à¸¸à¸¥à¹€à¸‡à¸´à¸™à¸­à¸±à¸•à¹‚à¸™à¸¡à¸±à¸•à¸´', m2_title:'à¸£à¸²à¸„à¸²à¸•à¹ˆà¸­à¸•à¸£.à¸¡.',
  s2_title:'à¸ªà¸ à¸²à¸à¸—à¸±à¹ˆà¸§à¹„à¸› â€” à¸„à¸°à¹à¸™à¸™', s2_sub:'1-5 à¸”à¸²à¸§à¸•à¹ˆà¸­à¸«à¹‰à¸­à¸‡',
  score_global:'à¸„à¸°à¹à¸™à¸™à¸£à¸§à¸¡', score_hint:'à¹ƒà¸«à¹‰à¸„à¸°à¹à¸™à¸™à¸«à¹‰à¸­à¸‡à¸”à¹‰à¸²à¸™à¸šà¸™',
  score_excellent:'ğŸŒŸ à¸¢à¸­à¸”à¹€à¸¢à¸µà¹ˆà¸¢à¸¡', score_good:'ğŸ‘ à¸™à¹ˆà¸²à¸ªà¸™à¹ƒà¸ˆ',
  score_neutral:'ğŸ¤” à¸¡à¸µà¸‚à¹‰à¸­à¸ªà¸‡à¸ªà¸±à¸¢', score_bad:'âš ï¸ à¸¡à¸µà¸›à¸±à¸à¸«à¸²à¸¡à¸²à¸',
  lbl_comment:'à¸„à¸§à¸²à¸¡à¸„à¸´à¸”à¹€à¸«à¹‡à¸™à¸—à¸±à¹ˆà¸§à¹„à¸›', ph_comment:'à¹à¸ªà¸‡à¸ªà¸§à¹ˆà¸²à¸‡ à¸ªà¸ à¸²à¸à¸—à¸±à¹ˆà¸§à¹„à¸›â€¦',
  s3_title:'à¸ˆà¸¸à¸”à¸ªà¸³à¸„à¸±à¸', s3_sub:'à¸‚à¹‰à¸­à¸”à¸µ à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢ à¸‡à¸²à¸™à¸‹à¹ˆà¸­à¸¡',
  lbl_positifs:'âœ… à¸‚à¹‰à¸­à¸”à¸µ', ph_positifs:'à¸§à¸´à¸§, à¹€à¸‡à¸µà¸¢à¸šà¸ªà¸‡à¸šâ€¦',
  lbl_negatifs:'âš ï¸ à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢', ph_negatifs:'à¹€à¸ªà¸µà¸¢à¸‡à¸£à¸šà¸à¸§à¸™, à¸„à¸§à¸²à¸¡à¸Šà¸·à¹‰à¸™â€¦',
  lbl_travaux:'ğŸ”¨ à¸‡à¸²à¸™à¸‹à¹ˆà¸­à¸¡à¹à¸‹à¸¡', ph_travaux:'à¹€à¸Šà¹ˆà¸™: à¸›à¸£à¸±à¸šà¸›à¸£à¸¸à¸‡à¸„à¸£à¸±à¸§',
  s4_title:'à¸à¸²à¸£à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ', s4_sub:'à¸„à¸³à¸•à¸±à¸”à¸ªà¸´à¸™à¸‚à¸­à¸‡à¸„à¸¸à¸“',
  dec_yes:'à¸ªà¸™à¹ƒà¸ˆ', dec_maybe:'à¸­à¸²à¸ˆà¸ˆà¸°', dec_no:'à¹„à¸¡à¹ˆà¸ªà¸™à¹ƒà¸ˆ',
  lbl_notes:'à¸šà¸±à¸™à¸—à¸¶à¸à¸ªà¹ˆà¸§à¸™à¸•à¸±à¸§', ph_notes:'à¸‚à¸±à¹‰à¸™à¸•à¸­à¸™à¸•à¹ˆà¸­à¹„à¸›â€¦',
  btn_generate:'à¸ªà¸£à¹‰à¸²à¸‡à¸£à¸²à¸¢à¸‡à¸²à¸™', result_title:'à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡',
  btn_copy:'à¸„à¸±à¸”à¸¥à¸­à¸', btn_print:'à¸à¸´à¸¡à¸à¹Œ', btn_new:'à¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡à¹ƒà¸«à¸¡à¹ˆ',
  confirm_reset:'à¸£à¸µà¹€à¸‹à¹‡à¸•à¹à¸šà¸šà¸Ÿà¸­à¸£à¹Œà¸¡?', copied:'à¸„à¸±à¸”à¸¥à¸­à¸à¸£à¸²à¸¢à¸‡à¸²à¸™à¹à¸¥à¹‰à¸§!',
  rooms:['à¸«à¹‰à¸­à¸‡à¸™à¸±à¹ˆà¸‡à¹€à¸¥à¹ˆà¸™','à¸„à¸£à¸±à¸§','à¸«à¹‰à¸­à¸‡à¸™à¸­à¸™à¸«à¸¥à¸±à¸','à¸«à¹‰à¸­à¸‡à¸™à¸­à¸™ 2','à¸«à¹‰à¸­à¸‡à¸™à¹‰à¸³','à¸«à¹‰à¸­à¸‡à¸ªà¸¸à¸‚à¸²','à¸—à¸²à¸‡à¹€à¸‚à¹‰à¸²','à¸£à¸°à¹€à¸šà¸µà¸¢à¸‡/à¸ªà¸§à¸™'],
  star_ph:'à¸„à¸§à¸²à¸¡à¸„à¸´à¸”à¹€à¸«à¹‡à¸™â€¦',
  rh:'à¸£à¸²à¸¢à¸‡à¸²à¸™à¸à¸²à¸£à¹€à¸¢à¸µà¹ˆà¸¢à¸¡à¸Šà¸¡à¸­à¸ªà¸±à¸‡à¸«à¸²à¸£à¸´à¸¡à¸—à¸£à¸±à¸à¸¢à¹Œ',
  rt:'à¸›à¸£à¸°à¹€à¸ à¸—',ra:'à¸—à¸µà¹ˆà¸­à¸¢à¸¹à¹ˆ',rd:'à¸§à¸±à¸™à¸—à¸µà¹ˆ',rag:'à¸•à¸±à¸§à¹à¸—à¸™',rs:'à¸à¸·à¹‰à¸™à¸—à¸µà¹ˆ',rr:'à¸«à¹‰à¸­à¸‡',rf:'à¸Šà¸±à¹‰à¸™',
  re:'à¸—à¸´à¸¨à¸—à¸²à¸‡',rdpe:'à¸à¸¥à¸±à¸‡à¸‡à¸²à¸™',rp:'à¸£à¸²à¸„à¸²',rconv:'à¸à¸²à¸£à¹à¸›à¸¥à¸‡à¸ªà¸à¸¸à¸¥à¹€à¸‡à¸´à¸™',rm2:'à¸£à¸²à¸„à¸²/à¸•à¸£.à¸¡.',
  rrating:'à¸„à¸°à¹à¸™à¸™à¹à¸•à¹ˆà¸¥à¸°à¸«à¹‰à¸­à¸‡',rscore:'à¸„à¸°à¹à¸™à¸™',retat:'à¸ªà¸ à¸²à¸à¸—à¸±à¹ˆà¸§à¹„à¸›',rkeys:'à¸ˆà¸¸à¸”à¸ªà¸³à¸„à¸±à¸',
  rpos:'à¸‚à¹‰à¸­à¸”à¸µ',rneg:'à¸‚à¹‰à¸­à¹€à¸ªà¸µà¸¢',rworks:'à¸‡à¸²à¸™à¸‹à¹ˆà¸­à¸¡',rdec:'à¸à¸²à¸£à¸•à¸±à¸”à¸ªà¸´à¸™à¹ƒà¸ˆ',rnotes:'à¸šà¸±à¸™à¸—à¸¶à¸',
  dl:{ oui:'âœ… à¸ªà¸™à¹ƒà¸ˆ','peut-etre':'ğŸ¤” à¸­à¸²à¸ˆà¸ˆà¸°', non:'âŒ à¹„à¸¡à¹ˆà¸ªà¸™à¹ƒà¸ˆ' },
  na:'â€”', unrated:'(à¹„à¸¡à¹ˆà¹ƒà¸«à¹‰à¸„à¸°à¹à¸™à¸™)', nonotes:'(à¹„à¸¡à¹ˆà¸¡à¸µà¸šà¸±à¸™à¸—à¸¶à¸)',
  tl:{ apt:'à¸„à¸­à¸™à¹‚à¸”à¸¡à¸´à¹€à¸™à¸µà¸¢à¸¡', house:'à¸šà¹‰à¸²à¸™', studio:'à¸ªà¸•à¸¹à¸”à¸´à¹‚à¸­', commercial:'à¸à¸²à¸“à¸´à¸Šà¸¢à¹Œ' }
}
};

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STATE */
let curCountry='fr', curLang='fr', selLang=null;
const roomKeys=['sejour','cuisine','chambre1','chambre2','sdb','wc','entree','exterieur'];

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LANDING */
function selectCountry(code){
  curCountry=code;
  document.querySelectorAll('.country-card').forEach(c=>c.classList.remove('selected'));
  document.getElementById('cc-'+code).classList.add('selected');
  const s2=document.getElementById('step2');
  s2.style.display='block'; s2.classList.add('fade-in');
  document.querySelectorAll('.lang-card').forEach(c=>c.classList.remove('selected'));
  selLang=null;
  document.getElementById('btnStart').classList.remove('visible');
}
function selectLang(lang){
  selLang=lang;
  document.querySelectorAll('.lang-card').forEach(c=>c.classList.remove('selected'));
  document.getElementById('lc-'+lang).classList.add('selected');
  document.getElementById('btnStart').classList.add('visible');
  const lbs={fr:'Ouvrir le formulaire â†’',en:'Open the form â†’',th:'à¹€à¸›à¸´à¸”à¹à¸šà¸šà¸Ÿà¸­à¸£à¹Œà¸¡ â†’'};
  document.getElementById('btnStart').textContent=lbs[lang]||lbs.fr;
}
function startForm(){
  if(!curCountry||!selLang)return;
  curLang=selLang;
  document.getElementById('landing').style.display='none';
  const fp=document.getElementById('formPage');
  fp.style.display='block'; fp.classList.add('fade-in');
  const c=COUNTRIES[curCountry];
  document.getElementById('topFlag').textContent=c.flag;
  document.getElementById('topName').textContent=c.name;
  updateLangBtns();
  applyTrans();
  rebuildStars();
  updateConvLabels();
  document.getElementById('dateVisit').valueAsDate=new Date();
  window.scrollTo(0,0);
}
function goBack(){
  document.getElementById('formPage').style.display='none';
  document.getElementById('landing').style.display='flex';
  window.scrollTo(0,0);
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• LANG */
function setLang(l){ curLang=l; updateLangBtns(); applyTrans(); rebuildStars(); updateConvLabels(); calcConv(); }
function updateLangBtns(){
  document.querySelectorAll('.lang-btn').forEach(b=>b.classList.remove('active'));
  [{fr:0,en:1,th:2}[curLang]].forEach(i=>document.querySelectorAll('.lang-btn')[i]?.classList.add('active'));
}
function t(k){ return (T[curLang]||{})[k]||(T.fr||{})[k]||k; }
function applyTrans(){
  document.querySelectorAll('[data-i18n]').forEach(el=>{
    const k=el.getAttribute('data-i18n');
    if(T[curLang][k]!==undefined)el.innerHTML=T[curLang][k];
  });
  document.querySelectorAll('[data-i18n-ph]').forEach(el=>{
    const k=el.getAttribute('data-i18n-ph');
    if(T[curLang][k]!==undefined)el.placeholder=T[curLang][k];
  });
  if(document.getElementById('scoreNum').textContent==='â€”')
    document.getElementById('scoreVerdict').textContent=t('score_hint');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CURRENCY LABELS */
function updateConvLabels(){
  const isEUR=COUNTRIES[curCountry].cur==='EUR';
  if(isEUR){
    document.getElementById('convLbl1').textContent='EUR â‚¬';
    document.getElementById('convLbl2').textContent='USD $';
    document.getElementById('convLbl3').textContent='THB à¸¿';
    document.getElementById('m2Lbl1').textContent='â‚¬ / mÂ²';
  } else {
    document.getElementById('convLbl1').textContent='THB à¸¿';
    document.getElementById('convLbl2').textContent='EUR â‚¬';
    document.getElementById('convLbl3').textContent='USD $';
    document.getElementById('m2Lbl1').textContent='à¸¿ / mÂ²';
  }
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• CALC */
document.getElementById('prixInput').addEventListener('input', calcConv);
document.getElementById('surfInput').addEventListener('input', calcConv);

function fmt(n){
  if(n>=1000000) return (n/1000000).toFixed(2)+'M';
  if(n>=1000) return Math.round(n).toLocaleString();
  return Math.round(n).toString();
}

function calcConv(){
  const raw=parseFloat(document.getElementById('prixInput').value.replace(/[^\d.]/g,''));
  const surf=parseFloat(document.getElementById('surfInput').value);
  const isEUR=COUNTRIES[curCountry].cur==='EUR';
  const pc=document.getElementById('priceConvert');
  const mb=document.getElementById('priceM2Box');

  if(!raw||raw<=0){ pc.classList.remove('visible'); mb.classList.remove('visible'); return; }

  const eur=isEUR?raw:raw*R.THB_EUR;
  const usd=isEUR?raw*R.EUR_USD:raw*R.THB_USD;
  const thb=isEUR?raw*R.EUR_THB:raw;

  pc.classList.add('visible');

  if(isEUR){
    document.getElementById('convAmt1').innerHTML=fmt(eur)+'<span class="conv-sym">â‚¬</span>';
    document.getElementById('convAmt2').innerHTML=fmt(usd)+'<span class="conv-sym">$</span>';
    document.getElementById('convAmt3').innerHTML=fmt(thb)+'<span class="conv-sym">à¸¿</span>';
  } else {
    document.getElementById('convAmt1').innerHTML=fmt(thb)+'<span class="conv-sym">à¸¿</span>';
    document.getElementById('convAmt2').innerHTML=fmt(eur)+'<span class="conv-sym">â‚¬</span>';
    document.getElementById('convAmt3').innerHTML=fmt(usd)+'<span class="conv-sym">$</span>';
  }

  if(surf>0){
    mb.classList.add('visible');
    if(isEUR){
      document.getElementById('m2Val1').textContent=fmt(eur/surf)+' â‚¬';
      document.getElementById('m2Val2').textContent=fmt(usd/surf)+' $';
      document.getElementById('m2Val3').textContent=fmt(thb/surf)+' à¸¿';
    } else {
      document.getElementById('m2Val1').textContent=fmt(thb/surf)+' à¸¿';
      document.getElementById('m2Val2').textContent=fmt(eur/surf)+' â‚¬';
      document.getElementById('m2Val3').textContent=fmt(usd/surf)+' $';
    }
  } else mb.classList.remove('visible');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAP */
function showMap(){
  const addr=document.getElementById('adresseInput').value.trim();
  const m=document.getElementById('map');
  m.classList.add('visible');
  if(!addr){m.innerHTML='<div style="padding:20px;color:var(--muted);text-align:center">'+t('ph_address')+'</div>';return;}
  m.innerHTML=`<iframe src="https://maps.google.com/maps?q=${encodeURIComponent(addr)}&output=embed&z=15" allowfullscreen loading="lazy"></iframe>`;
}
document.getElementById('adresseInput').addEventListener('keydown',e=>{if(e.key==='Enter'){e.preventDefault();showMap();}});

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• STARS */
function rebuildStars(){
  const sf=document.getElementById('starField');
  const saved={};
  roomKeys.forEach(k=>{
    const c=document.querySelector(`[name="room_${k}"]:checked`);
    const cm=document.querySelector(`[name="comment_${k}"]`);
    saved[k]={v:c?c.value:null,c:cm?cm.value:''};
  });
  sf.innerHTML='';
  (T[curLang].rooms||T.fr.rooms).forEach((label,idx)=>{
    const key=roomKeys[idx];
    const row=document.createElement('div');
    row.className='star-row';
    row.innerHTML=`
      <div class="star-name">${label}</div>
      <div class="stars">${[5,4,3,2,1].map(i=>`<input type="radio" name="room_${key}" id="r${key}${i}" value="${i}" ${saved[key]?.v==i?'checked':''}/><label for="r${key}${i}">â˜…</label>`).join('')}</div>
      <input class="star-comment" type="text" name="comment_${key}" placeholder="${t('star_ph')}" value="${saved[key]?.c||''}"/>
    `;
    sf.appendChild(row);
  });
  document.querySelectorAll('.stars input').forEach(i=>i.addEventListener('change',updateScore));
  updateScore();
}

function updateScore(){
  let total=0,count=0;
  roomKeys.forEach(k=>{const c=document.querySelector(`[name="room_${k}"]:checked`);if(c){total+=parseInt(c.value);count++;}});
  const avg=count?total/count:null;
  document.getElementById('scoreNum').textContent=avg?avg.toFixed(1):'â€”';
  document.getElementById('scoreBar').style.width=avg?(avg/5*100)+'%':'0%';
  const v=document.getElementById('scoreVerdict');
  if(!avg){v.textContent=t('score_hint');return;}
  if(avg>=4)v.textContent=t('score_excellent');
  else if(avg>=3)v.textContent=t('score_good');
  else if(avg>=2)v.textContent=t('score_neutral');
  else v.textContent=t('score_bad');
}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• UI */
function selectType(el){document.querySelectorAll('.type-btn').forEach(b=>b.classList.remove('selected'));el.classList.add('selected');}
function selectDecision(el){document.querySelectorAll('.decision-btn').forEach(b=>b.classList.remove('selected'));el.classList.add('selected');}
function g(n){const el=document.querySelector(`[name="${n}"]`);return el?el.value.trim():'';}

/* â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• REPORT */
function generateReport(){
  const L=T[curLang];
  const c=COUNTRIES[curCountry];
  const isEUR=c.cur==='EUR';
  const tv=document.querySelector('[name="type"]:checked')?.value||'';
  const raw=parseFloat(document.getElementById('prixInput').value.replace(/[^\d.]/g,''));
  const surf=parseFloat(document.getElementById('surfInput').value);

  let priceBlock='';
  if(g('prix'))priceBlock+=`${L.rp.padEnd(14)}: ${g('prix')}\n`;
  if(raw>0){
    const eur=isEUR?raw:raw*R.THB_EUR;
    const usd=isEUR?raw*R.EUR_USD:raw*R.THB_USD;
    const thb=isEUR?raw*R.EUR_THB:raw;
    priceBlock+=`${L.rconv.padEnd(14)}: ${fmt(eur)} â‚¬ Â· ${fmt(usd)} $ Â· ${fmt(thb)} à¸¿\n`;
    if(surf>0) priceBlock+=`${L.rm2.padEnd(14)}: ${fmt(eur/surf)} â‚¬/mÂ² Â· ${fmt(usd/surf)} $/mÂ² Â· ${fmt(thb/surf)} à¸¿/mÂ²\n`;
  }

  let roomLines='';
  (L.rooms||T.fr.rooms).forEach((label,idx)=>{
    const key=roomKeys[idx];
    const ch=document.querySelector(`[name="room_${key}"]:checked`);
    const note=ch?'â˜…'.repeat(parseInt(ch.value))+'â˜†'.repeat(5-parseInt(ch.value)):L.unrated;
    const cm=g(`comment_${key}`);
    roomLines+=`  ${label.padEnd(20)} ${note}${cm?' â€” '+cm:''}\n`;
  });

  const dec=document.querySelector('[name="decision"]:checked')?.value||'';
  const decL=dec?(L.dl[dec]||dec):L.na;
  const score=document.getElementById('scoreNum').textContent;

  const report=`
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ${L.rh}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
${L.rt.padEnd(14)}: ${L.tl[tv]||tv}
${L.ra.padEnd(14)}: ${g('adresse')||L.na}
${L.rd.padEnd(14)}: ${g('date_visite')||L.na}   ${L.rag}: ${g('agent')||L.na}
${L.rs.padEnd(14)}: ${g('surface')?g('surface')+' mÂ²':L.na}   ${L.rr}: ${g('pieces')||L.na}   ${L.rf}: ${g('etage')||L.na}
${L.re.padEnd(14)}: ${g('exposition')||L.na}   ${L.rdpe}: ${g('dpe')||L.na}
${priceBlock}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ${L.rrating}   (${L.rscore}: ${score}/5)
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
${roomLines}
${L.retat}: ${g('comment_etat')||L.na}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ${L.rkeys}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
âœ… ${L.rpos}: ${g('positifs')||L.na}
âš ï¸  ${L.rneg}: ${g('negatifs')||L.na}
ğŸ”¨ ${L.rworks}: ${g('travaux')||L.na}

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
  ${L.rdec}: ${decL}
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
${g('notes')||L.nonotes}
  `.trim();

  document.getElementById('resultText').textContent=report;
  const r=document.getElementById('result');
  r.style.display='block';
  r.scrollIntoView({behavior:'smooth',block:'start'});
}

function copyReport(){ navigator.clipboard.writeText(document.getElementById('resultText').textContent).then(()=>alert(t('copied'))); }
function printPage(){ window.print(); }
function resetForm(){
  if(!confirm(t('confirm_reset')))return;
  document.getElementById('visitForm').reset();
  document.getElementById('result').style.display='none';
  document.getElementById('scoreNum').textContent='â€”';
  document.getElementById('scoreBar').style.width='0%';
  document.getElementById('dateVisit').valueAsDate=new Date();
  document.querySelectorAll('.type-btn').forEach((b,i)=>b.classList.toggle('selected',i===0));
  document.querySelectorAll('.decision-btn').forEach(b=>b.classList.remove('selected'));
  document.getElementById('map').classList.remove('visible');
  document.getElementById('priceConvert').classList.remove('visible');
  document.getElementById('priceM2Box').classList.remove('visible');
  rebuildStars();
  window.scrollTo({top:0,behavior:'smooth'});
}
</script>
</body>
</html>
